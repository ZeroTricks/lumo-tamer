# Authentication configuration
# - browser: token extraction via browser (recommended)
# - login: enter Proton credentials via go-proton-api
# - rclone: paste rclone config via `npm run extract-rclone`
# See docs/authentication.md
auth:
  method: "browser"
  tokenPath: "sessions/auth-tokens.json"
  # Auto-refresh: automatically refresh tokens before they expire
  autoRefresh:
    enabled: true             # Enable automatic token refresh (default: true)
    intervalHours: 20         # Refresh interval in hours (1-24, default: 20)
    onError: true             # Refresh tokens on 401 errors (default: true)
  # Browser-specific config (only used when method: browser)
  browser:
    # Chrome DevTools Protocol endpoint for remote browser
    cdpEndpoint: "http://browser-dev:9223"
  # Login-specific config (only used when method: login)
  # All fields have defaults - override only if needed
  # login:
  #   binaryPath: "./dist/proton-auth"  # Path to proton-auth Go binary
  #   # Headers to help avoid CAPTCHA - see docs/authentication.md
  #   appVersion: "macos-drive@1.0.0-alpha.1+rclone"
  #   userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) ..."

# Shared Logging Configuration (can be overridden in server/cli sections)
log:
  level: "info"  # Levels: trace, debug, info, warn, error, fatal
  target: "stdout"  # "stdout" or "file"
  filePath: "lumo-bridge.log"  # Used when target is "file"
  messageContent: false  # Log user/assistant message content (disabled by default for privacy)

# Shared Conversations Configuration (can be overridden in server/cli sections)
# Note: In-memory conversation storage is always active regardless of sync settings
conversations:
  maxInMemory: 100          # Max conversations to keep in memory (LRU eviction)
  # WORKAROUND for clients without conversation_id support (e.g., Home Assistant).
  # Derives conversation ID from first user message - same message = same conversation.
  # WARNING: May incorrectly merge unrelated conversations with same opening message!
  deriveIdFromFirstMessage: false
  # Sync: persist conversations to Proton servers (requires browser auth)
  sync:
    enabled: false          # Enable syncing to Proton servers
    spaceName: lumo-bridge  # Space name for conversations (created if doesn't exist)
    # spaceId: "uuid"       # Optional: use specific space UUID instead of name matching
    includeSystemMessages: false  # Include system/tool messages in sync (default: user/assistant only)
    autoSync: false         # Auto-sync vs manual /save command

# Shared Tools Configuration (can be overridden in server/cli sections)
tools:
  # Enable client-side tool detection in responses from Lumo.
  # WARNING:
  # - When enabled, Lumo can trigger actions on your machine/client!
  # - Status: experimental
  #
  # API: Detects JSON tool calls ({"name":"...", "arguments":{...}}) for calling functions provided in the request.
  # CLI: Detects code blocks (```bash, ```python) and prompts for execution. 
  # Each action requires confirmation, but only enable if you understand the implications.
  enabled: false
  # Enable Lumo's native web_search tool (and other external tools: weather, stock, cryptocurrency)
  enableWebSearch: true

# Shared Commands Configuration (can be overridden in server/cli sections)
commands:
  # Enable slash commands (/save, /help, /logout, etc.)
  # When disabled, commands are ignored and treated as regular messages.
  enabled: true

# Shared Instructions configuration (can be overridden in server/cli sections)
instructions:
  # Default instructions when no system/developer message provided
  default: "Always answer in plain text. Don't use tables, quote blocks, lists, etc. Be concise."

  # If true, append request instructions to default; if false, request replaces default
  append: false



# Server Configuration (for `npm run server` / `npm run dev:server`)
server:
  port: 3003
  apiKey: "your-secret-api-key-here"
  apiModelName: "lumo"
  # Mode-specific overrides (optional):
  instructions:
    # Description text for tools (prepended to tools JSON)
    forTools: |
      Use the tools below to accomplish tasks.
      To call them you MUST output the JSON to the user, unlike your existing tools like proton_info or web search.
      You have the power to execute these functions by providing the JSON directly to the user, without trying to call them yourself. The user will execute these functions and return the results to you. This is crucial. Do NOT tell a tool is unavailable, instead just output the JSON for the tool call.
  # log:
  #   level: "debug"
  #   target: "file"
  # conversations:
  #   sync:
  #     enabled: true

# CLI Configuration (for `npm run cli` / `npm run dev:cli`)
cli:
#   log:
#     target: "file"
#     filePath: "lumo-bridge-cli.log"
#   tools:
#     enabled: true  # Enable code block detection and execution
  instructions:
    default: |
      You are a command line assistant. Your output will be read in a terminal. Keep the formatting to a minimum and be concise.
    # forTools is appended when tools.enabled=true
    forTools: |
      You can execute bash commands on the user's machine.
      When you provide a ```bash code block, the user will be prompted to execute it. Don't explain the user can execute commands, it will be done for him.
      Output will be returned to you. Keep commands simple and safe.

